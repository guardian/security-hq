@import logic.DateUtils
@import model._
@import logic.CredentialsReportDisplay
@import org.joda.time.DateTime
@import logic.GcpDisplay
@(findings: List[GcpFinding], date: DateTime)

<div class="row">
    <div class="card-panel">
        <span>Report generated at @{DateUtils.printTime(date)} (refreshed every four hours)</span>
    </div>
</div>
<div class="row">
    <div class="col s12">
        <table class="striped responsive-table gcp-report__table">
            <thead>
                <tr>
                    <th class="gcp-table-row-severity">Severity</th>
                    <th class="gcp-table-row-category">Category</th>
                    <th class="gcp-table-row-date">Date</th>
                    <th>Explanation</th>
                    <th>Recommendation</th>
                </tr>
            </thead>
            <tbody>
                @for(finding <- findings) {
                    <tr class="finding-@finding.severity.toLowerCase">
                        <td class="gcp-table-row-severity"><span>@finding.severity</span></td>
                        <td class="gcp-table-row-category"><span>@finding.category</span></td>
                        <td class="gcp-table-row-date"><span>@finding.eventTime.toString(GcpDisplay.dateTimePattern)</span></td>
                        <td><span>@finding.explanation</span></td>
                        <td>
                        @*if the text is less than 40 chars, show it*@
                        @if(finding.recommendation.getOrElse("").length < 30) {
                            <span class="unaltered-short">@finding.recommendation</span>} else {
                            @*if not, trim the text to show only 40 chars and add ... to the end*@
                            <span class="truncated">@GcpDisplay.preview(finding.recommendation.getOrElse(""), 30)</span>
                            <span class="full-text">@finding.recommendation</span>
                            <span class="js-read-more">...Read More</span>}
                        </td>
                            @*in the td:
                                span 0 = unaltered-short
                                span 1 = truncated
                                span 2 = full text (css: hidden by default)
                                span 3 = read more button
                            add *click handler* to read more button (when clicked, shown span 2, hide span 1)
                            https://api.jquery.com/click/
                                *find parent*
                            https://api.jquery.com/parent/
                            *find the children with certain class names*
                            https://api.jquery.com/find/
                            *@
                        }
                    </tr>
            </tbody>
        </table>
    </div>
</div>
    

